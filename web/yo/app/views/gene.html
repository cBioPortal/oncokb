<div ng-hide="status.rendering" ng-if="gene" class="geneMainDiv" ng-style="geneMainDivStyle">
  <div id="gene" style="margin-bottom:50px">
     <h2>
      <!-- Gene: <span>{{gene.name.text}}</span> -->
      Gene: <span>{{::gene.name.text}}</span><comments-dict file-editable="fileEditable" comments="gene.name_comments" object="gene" key="name" add-comment="addComment(arg1,arg2,arg3)"></comments-dict>
      <span ng-repeat="collaborator in collaborators">
        <img style="height:30px" ng-src="{{::collaborator.photoUrl}}" uib-tooltip-placement="top" uib-tooltip="{{::collaborator.displayName}}">
      </span>
      <span ng-if="::(document && gene.status_timeStamp.has('lastEdit'))" class="geneLastModify">Last edit was made on {{gene.status_timeStamp.get('lastEdit').value.text | date : 'MMM d, h:mm a yyyy'}} by {{gene.status_timeStamp.get('lastEdit').by.text }}</span>
      <span ng-if="::(document && userRole === 8 && gene.status_timeStamp.has('lastUpdate'))" class="geneLastModify">Last update to database was made on {{gene.status_timeStamp.get('lastUpdate').value.text  | date : 'MMM d, h:mm a'}} by {{gene.status_timeStamp.get('lastUpdate').by.text }}</span>
      <span class="btn-group btn-group-sm pull-right top-tools-menu" uib-dropdown>
        <button type="button" class="btn btn-default" ng-if="::(userRole === 8 && internal)" ng-disabled="!fileEditable || !metaDocStatus.saved" ng-click="review()">{{reviewMode ? 'Review Complete' : 'Review'}}</button>
        <button type="button" class="btn btn-default" ng-if="developerCheck()" ng-click="exitReview()">Exit Review</button>
        <!--<button type="button" class="btn btn-default" ng-click="getData()">Gene</button>-->
        <button type="button" class="btn btn-default" ng-click="getAllCitations()">Citations</button>
        <button type="button" class="btn btn-default" uib-dropdown-toggle ng-if="::(userRole === 8)">
          More tools
          <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" uib-dropdown-menu role="menu" aria-labelledby="btn-append-to-body" ng-if="::(userRole === 8)">
          <li ng-click="generatePDF()"><a><i class="fa fa-download"></i>Download PDF</a></li>
          <li ng-click="status.hideAllEmpty=true"><a><i class="fa fa-eye-slash"></i>Hide all empty</a></li>
          <li ng-click="status.hideAllEmpty=false"><a><i class="fa fa-eye"></i>Show all empty</a></li>
          <li ng-click="status.hideAllObsolete=true"><a><i class="fa fa-eye-slash"></i>Hide all obsolete</a></li>
          <li ng-click="status.hideAllObsolete=false"><a><i class="fa fa-eye"></i>Show all obsolete</a></li>
          <li ng-if="(status.numAccordion < 100 && gene.mutations.length < 20) || (status.numAccordion < 200 && gene.mutations.length < 6)" ng-click="status.expandAll=true"><a><i class="fa fa-expand"></i>Expand all</a></li>
          <li ng-if="(status.numAccordion < 100 && gene.mutations.length < 20) || (status.numAccordion < 200 && gene.mutations.length < 6)" ng-click="status.expandAll=false"><a><i class="fa fa-compress"></i>Collapse all</a></li>
        </ul>

        <button type="button" class="btn btn-default" ng-click="status.hideAllEmpty=true" ng-if="::(userRole === 4)">
          <i class="fa fa-eye"></i>Hide all empty
        </button>
        <button type="button" class="btn btn-default" ng-click="status.hideAllEmpty=false" ng-if="::(userRole === 4)">
          <i class="fa fa-eye"></i>Show all empty
        </button>
        <button type="button" class="btn btn-default"  ng-click="status.expandAll=true"
                ng-if="userRole === 4 && ((status.numAccordion < 100 && gene.mutations.length < 20) || (status.numAccordion < 200 && gene.mutations.length < 6))">
          <i class="fa fa-expand"></i>Expand all
        </button>
        <button type="button" class="btn btn-default"  ng-click="status.expandAll=false"
                ng-if="userRole === 4 && ((status.numAccordion < 100 && gene.mutations.length < 20) || (status.numAccordion < 200 && gene.mutations.length < 6))">
          <i class="fa fa-compress"></i>Collapse all
        </button>
      </span>

    </h2>
      <div ng-if="meta.gene" class="subtitle subtitle-1">
          <span class="entrezGene" ng-if="meta.gene.entrezGeneId > 0">Entrez Gene: {{::meta.gene.entrezGeneId}}<a target="_blank" ng-href="https://www.ncbi.nlm.nih.gov/gene/?term={{::meta.gene.entrezGeneId}}"><i class="fa fa-external-link"></i></a></span>
          <div ng-if="meta.gene.geneAliases && meta.gene.geneAliases.length > 0">
              <span class="header">Also known as</span>
              <span ng-repeat="alias in meta.gene.geneAliases" class="alias-item">{{::alias}}<a target="_blank" ng-href="https://www.ncbi.nlm.nih.gov/pubmed/?term={{::alias}}"><i class="fa fa-external-link"></i></a><span ng-if="!$last" class="comma">,</span>
              </span>
          </div>
      </div>
      <div ng-if="!reviewMode && gene.transcripts.asArray().length > 0" class="subtitle subtitle-2">Transcript:
          {{::gene.transcripts.asArray()[0].isoform_override.text}},
          {{::gene.transcripts.asArray()[0].dmp_refseq_id.text}}</div>
      <div ng-if="reviewMode">
          <br/><br/>
          <p style="color:red;font-size:20px;"><b>You are currently in "Review" mode. Click the "Review Complete" button to exit.</b></p>
          <span class="btn-group">
              <button type="button" class="btn btn-default" ng-click="acceptChangesByPerson(x)"
                      ng-disabled="status[x].noChanges || status[x].savingAll" ng-repeat="x in namesWithChanges" ng-bind-html="getButtonContent(x)"></button>
          </span>
      </div>

    <div ng-if="displayPrecisely(gene.summary_uuid, gene.summary_review)">
        <h3>{{::gene.summary.display}}:
          <comments-dict file-editable="fileEditable" comments="gene.summary_comments" object="gene" key="summary" add-comment="addComment(arg1,arg2,arg3)"></comments-dict>
          <e-status ng-show="!reviewMode && fileEditable" ng-click="commentClick($event)" ng-keypress="stopCollopse($event)" object="gene.summary_eStatus" id="'gene-summary'" apply-obsolete="applyObsolete(gene.summary_eStatus, 'GENE_SUMMARY')"></e-status>
          <review-panel ng-if="reviewMode" review-obj="gene.summary_review" evidence-type="'GENE_SUMMARY'" obj="gene" get-evidence="getEvidence(type)" model-update="modelUpdate(type)"></review-panel>
        </h3>
        <drive-realtime-string review-obj="gene.summary_review" uuid="::gene.summary_uuid" es="gene.summary_eStatus" fe="geneEditable" t="'p'" object="gene.summary"></drive-realtime-string>
    </div>
    <div ng-if="displayPrecisely(gene.type_uuid, gene.type_review)">
        <h3 ng-if="reviewMode">Gene Type:
            <review-panel ng-if="reviewMode" review-obj="gene.type_review" evidence-type="'GENE_TYPE'" obj="gene" get-evidence="getEvidence(type)" model-update="modelUpdate(type)"></review-panel>
        </h3>
        <span><h4 style="margin-bottom:-10px" ng-if="reviewMode && !gene.type_review.get('action')">New Content:</h4></span>
        <div>
            <span style="float:left">
            <drive-realtime-string review-obj="gene.type_review" uuid="::gene.type_uuid" fe="geneEditable" t="'checkbox'" object="gene.type" objecttype="'object'" objectkey="'TSG'" checkboxes="checkboxes['TSG']" checkboxid="'TSG'"></drive-realtime-string>
            </span>
            <span style="float:left">
                <drive-realtime-string review-obj="gene.type_review" uuid="::gene.type_uuid" fe="geneEditable" t="'checkbox'" object="gene.type" objecttype="'object'" objectkey="'OCG'" checkboxes="checkboxes['OCG']" checkboxid="'OCG'"></drive-realtime-string>
            </span>
        </div>
        <div ng-if="reviewMode">
            <span ng-if="!gene.type_review.get('action')">
                <br/><br/>
                <h4>Old Content:</h4>
            </span>
            <div>
                <input
                    id="TSG-review"
                    type="radio"
                    ng-checked="(!gene.type_review.get('action') ?  gene.type_review.get('lastReviewed')['TSG'] : gene.type.get('TSG'))  === 'Tumor Suppressor' ? true : false"
                    ng-disabled="true">
                <label for="TSG-review">Tumor Suppressor</label>
                <input
                    id="OCG-review"
                    type="radio"
                    ng-checked="(!gene.type_review.get('action') ? gene.type_review.get('lastReviewed')['OCG'] : gene.type.get('OCG')) === 'Oncogene' ? true : false"
                    ng-disabled="true">
                <label for="OCG-review">Oncogene</label>
            </div>
        </div>
    </div>
    <div ng-if="displayPrecisely(gene.background_uuid, gene.background_review)">
        <br/><br/>
        <h3>{{::gene.background.display}}:
            <comments-dict file-editable="fileEditable" comments="gene.background_comments" object="gene" key="background" add-comment="addComment(arg1,arg2,arg3)"></comments-dict>
            <e-status ng-show="!reviewMode && fileEditable" ng-click="commentClick($event)" ng-keypress="stopCollopse($event)" object="gene.background_eStatus" id="'gene-background'" apply-obsolete="applyObsolete(gene.background_eStatus, 'GENE_BACKGROUND')"></e-status>
            <review-panel ng-if="reviewMode" review-obj="gene.background_review" evidence-type="'GENE_BACKGROUND'" obj="gene" get-evidence="getEvidence(type)" model-update="modelUpdate(type)"></review-panel>
        </h3>
        <drive-realtime-string review-obj="gene.background_review" uuid="::gene.background_uuid"  es="gene.background_eStatus" fe="geneEditable" t="'p'" object="gene.background"></drive-realtime-string>
    </div>
    <div ng-if="gene.name.text && !reviewMode">
      <table class="table geneLinks">
        <tbody>
        <tr>
          <td>cBioPortal link: </td>
          <td><a href="https://cbioportal.mskcc.org/ln?q={{::gene.name.text}}" target="_blank">https://cbioportal.mskcc.org/ln?q={{::gene.name.text}}</a></td>
        </tr>
        <tr>
          <td>COSMIC link: </td>
          <td><a href="http://cancer.sanger.ac.uk/cosmic/gene/overview?ln={{::gene.name.text}}" target="_blank">http://cancer.sanger.ac.uk/cosmic/gene/overview?ln={{::gene.name.text}}</a></td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>
  <div id="mutation">
    <uib-accordion close-others="false">
      <div ng-repeat="mutation in gene.mutations.asArray()" ng-init="initGeneStatus(mutation);tmpGeneStatus=getGeneStatusItem(mutation)" class="accordionMarginTop" ng-hide="status.hideAllObsolete && mutation.name_eStatus.get('obsolete') === 'true'">
        <uib-accordion-group is-open="tmpGeneStatus.isOpen" class="levelOneHeader" ng-if="displayCheck(mutation.name_review, mutation.name_review)">
          <uib-accordion-heading>
            <i class="fa  " ng-class="{'fa-chevron-down': geneStatus[$index].isOpen, 'fa-chevron-right': !geneStatus[$index].isOpen}"></i>
            <span>Mutation: </span>
              <!--<span ng-click="stopCollopse($event)" ng-class="{editableBox:mutationNameEditable(mutation.name.text), unEditableBox:!mutationNameEditable(mutation.name.text)}" contenteditable="{{mutationNameEditable(mutation.name.text)}}" ng-model="mutation.name.text"/></span>-->
              <div style="display:inline-block">
                 <drive-realtime-string review-obj="mutation.name_review" mutation-messages="mutationMessages" uuid="::mutation.name_uuid"  es="mutation.name_eStatus" fe="fileEditable" t="'MUTATION_NAME'" object="mutation.name" mutation="mutation" get-mutation-messages="getMutationMessages()" ng-click="stopCollopse($event)"></drive-realtime-string>
              </div>
            <div style="display:inline-block">
                <comments-dict ng-click="commentClick($event)" ng-keypress="stopCollopse($event)" file-editable="fileEditable" comments="mutation.name_comments" object="mutation" key="name" add-comment="addComment(arg1,arg2,arg3)"></comments-dict>
                <i class="fa fa-hand-o-left" uib-tooltip-placement="top" uib-tooltip="Red: needs to be curated" ng-show="mutation.oncogenic_eStatus.get('curated')===false || userRole === 8" ng-click="curatedIconClick($event, mutation.oncogenic_eStatus)" ng-class="{'fa-comments-red':mutation.oncogenic_eStatus.get('curated')===false}"></i>
            </div>
            <span class="pull-right" ng-show="!reviewMode && fileEditable">
                <e-status ng-click="commentClick($event)" ng-keypress="stopCollopse($event)" object="mutation.name_eStatus" id="mutation.name.text  + '-name'" apply-obsolete="applyObsolete(mutation.name_eStatus, 'mutation', mutation)"></e-status>
              <span style="margin-right: 20px">
                <i class="fa fa-angle-up" ng-if="$index !== 0" ng-click="move(gene.mutations, $index, $index, $event)"></i>
                <i class="fa fa-angle-down" ng-if="$index !== gene.mutations.length-1" ng-click="move(gene.mutations, $index, $index+2, $event)"></i>
                <i class="fa fa-angle-double-up" ng-if="$index > 1" ng-click="move(gene.mutations, $index, 0, $event)"></i>
                <i ng-if="$index < gene.mutations.length-2" class="fa fa-angle-double-down" ng-click="move(gene.mutations, $index, gene.mutations.length, $event)"></i>
              </span>
              <i ng-click="remove($event, 'mutation', mutation)" class="fa fa-trash-o"></i>
            </span>
              <span class="pull-right">
                  <review-panel ng-if="reviewMode" review-obj="mutation.name_review" evidence-type="'mutation'" mutation="mutation" get-evidence="getEvidence(type, mutation)" model-update="modelUpdate(type, mutation)"
                                accept-added="acceptAdded(event, type, mutation, tumor, ti, treatment)" reject-added="rejectAdded(event, type, mutation, tumor, ti, treatment)"
                                confirm-delete="confirmDelete(event, type, mutation, tumor, ti, treatment)" cancel-delete="cancelDelete(event, type, mutation, tumor, ti, treatment)"></review-panel>
              </span>
          </uib-accordion-heading>
          <uib-accordion ng-if="tmpGeneStatus.isOpen" close-others="false">
            <!-- Mutation Effect -->
            <uib-accordion-group ng-init="tmpGeneStatus=getGeneStatusItem(mutation, null, null, null, 'oncogenic')" ng-if="displayCheck(mutation.oncogenic_review, mutation.name_review)" is-open="tmpGeneStatus.isOpen" class="levelTwoHeader" ng-hide="((!!tmpGeneStatus.hideEmpty) && checkEmpty(mutation, 'oncogenicity')) || (status.hideAllObsolete && mutation.shortSummary_eStatus.get('obsolete') === 'true')">
              <uib-accordion-heading>
                <i class="fa  " ng-class="{'fa-chevron-down': tmpGeneStatus.isOpen, 'fa-chevron-right': !tmpGeneStatus.isOpen}" ng-click="tmpGeneStatus.isOpen"></i>
                <span>Mutation Effect</span><span ng-click="stopCollopse($event)" class="curationNoEntry" ng-if="checkEmpty(mutation, 'oncogenicity')">No Entry</span><comments-dict file-editable="fileEditable" comments="mutation.shortSummary_comments" object="mutation" key="shortSummary" ng-click="commentClick($event)" ng-keypress="stopCollopse($event)" add-comment="addComment(arg1,arg2,arg3)"></comments-dict>
                <span class="pull-right" ng-show="!reviewMode && fileEditable">
                   <e-status ng-click="commentClick($event)" ng-keypress="stopCollopse($event)" object="mutation.shortSummary_eStatus" id="mutation.name.text  + '-shortSummary'"  apply-obsolete="applyObsolete(mutation.shortSummary_eStatus, 'ONCOGENIC', mutation)"></e-status>
                </span>
                <review-panel ng-if="reviewMode" review-obj="mutation.oncogenic_review" evidence-type="'ONCOGENIC'" mutation="mutation" get-evidence="getEvidence(type, mutation)" model-update="modelUpdate(type, mutation)"></review-panel>
              </uib-accordion-heading>
                <p ng-class="{'seperationLine': reviewMode}" ng-if="displayPrecisely(mutation.oncogenic_uuid, mutation.oncogenic_review)">
                    <strong style="float: left">{{::mutation.oncogenic.display}}:</strong>
                    <drive-realtime-string review-obj="mutation.oncogenic_review" uuid="::mutation.oncogenic_uuid" es="mutation.shortSummary_eStatus" fe="fileEditable" t="'checkbox'" object="mutation.oncogenic" checkboxes="checkboxes['oncogenic']" checkboxid="mutation.name.text + '-shortSummary-box-'"></drive-realtime-string>
                </p>
                <div class="mutationEffect" ng-if="displayPrecisely(mutation.effect_uuid, mutation.effect_review)">
                    <strong class="header">Mutation effect:</strong>
                    <div>
                        <drive-realtime-string review-obj="mutation.effect_review" uuid="::mutation.effect_uuid" es="mutation.oncogenic_eStatus" fe="fileEditable" t="'checkbox'" object="mutation.effect.value" checkboxes="checkboxes['mutationEffect']" checkboxid="mutation.name.text + '-mutation-effect-box-'" addon="mutation.effect.addOn" ph="' Optional text'"></drive-realtime-string>
                    </div>
                </div>
                <br/>
                <span ng-if="displayPrecisely(mutation.description_uuid, mutation.description_review)">
                    <strong>Description of Evidence:</strong>
                    <br/>
                    <drive-realtime-string review-obj="mutation.description_review" uuid="::mutation.description_uuid" es="mutation.oncogenic_eStatus" fe="fileEditable" t="'p'" object="mutation.description" io="tmpGeneStatus.isOpen"></drive-realtime-string>
                  </span>
                <span ng-if="!reviewMode">
                    <strong>Additional Information (Optional):</strong>
                    <br/>
                    <drive-realtime-string es="mutation.oncogenic_eStatus" fe="fileEditable" t="'p'" object="mutation.short" io="tmpGeneStatus.isOpen"></drive-realtime-string>
                  </span>
            </uib-accordion-group>
            <!-- tumor types -->
            <div ng-repeat="tumor in mutation.tumors.asArray()" ng-init="initGeneStatus(mutation, tumor); getTumorMessages(mutation)" class="accordionMarginTop" ng-hide="status.hideAllObsolete && tumor.name_eStatus.get('obsolete') === 'true'">
              <uib-accordion-group ng-init="tmpGeneStatus=getGeneStatusItem(mutation, tumor)" ng-if="displayCheck(tumor.name_review, mutation.name_review, tumor.name_review, tumor.cancerTypes_review)" is-open="tmpGeneStatus.isOpen" class="levelTwoHeader">
                <uib-accordion-heading >
                  <i class="fa  " ng-class="{'fa-chevron-down':tmpGeneStatus.isOpen, 'fa-chevron-right': !tmpGeneStatus.isOpen}"></i>
                  <span>Tumor type: </span>
                    <span ng-if="reviewMode && tumor.cancerTypes_review.get('lastReviewed') !== null && !tumor.name_review.get('added')">
                        <br/>
                        <p>New Content: </p>
                    </span>
                  <span>{{getCancerTypesName(tumor.cancerTypes)}}</span>
                    <i class="fa fa-edit" ng-click="stopCollopse($event); modifyTumorType(tumor, mutation)" ng-if="!reviewMode"></i>
                    <span style="color:red" ng-if="!reviewMode">{{getTumorDuplication(mutation, tumor)}}</span>
                    <span class="original-tumor-type"
                          ng-if="getCancerTypesName(tumor.cancerTypes).toLowerCase() !== tumor.name.text.toLowerCase() && tumor.name.text">Original Tumor Type: {{tumor.name.text}}</span>
                    <comments-dict file-editable="fileEditable" comments="tumor.name_comments" object="tumor" key="name" add-comment="addComment(arg1,arg2,arg3)" ng-click="commentClick($event)" ng-keypress="stopCollopse($event)"></comments-dict>
                  <!--<span ng-click="stopCollopse($event)" ng-class="{unEditableBox: true}" contenteditable="false"/>{{getCancerTypeName(tumor.cancerTypes)}}</span><comments-dict mutation="{{mutation.name.text}}" tumor-type="{{tumor.name.text}}" gene-name="{{::gene.name.text}}"file-editable="fileEditable" comments="tumor.name_comments" object="tumor" key="name" add-comment="addComment(arg1,arg2,arg3)" ng-click="commentClick($event)" ng-keypress="stopCollopse($event)"></comments-dict>-->
                  <span class="pull-right" ng-show="!reviewMode && fileEditable">
                    <span style="margin-right: 20px">
                        <e-status ng-click="commentClick($event)" ng-keypress="stopCollopse($event)" object="tumor.name_eStatus" id="tumor.name.text  + '-name'" apply-obsolete="applyObsolete(tumor.name_eStatus, 'tumor', mutation, tumor)"></e-status>
                        <i class="fa fa-angle-up" ng-if="$index !== 0" ng-click="move(mutation.tumors, $index, $index, $event)"></i>
                      <i class="fa fa-angle-down" ng-if="$index !== mutation.tumors.length-1" ng-click="move(mutation.tumors, $index, $index+2, $event)"></i>
                      <i class="fa fa-angle-double-up" ng-if="$index > 1" ng-click="move(mutation.tumors, $index, 0, $event)"></i>
                      <i ng-if="$index < mutation.tumors.length-2" class="fa fa-angle-double-down" ng-click="move(mutation.tumors,$index, mutation.tumors.length, $event)"></i>
                    </span>
                    <i ng-click="remove($event, 'tumor', mutation, tumor)" class="fa fa-trash-o pull-right"></i>
                  </span>
                    <span ng-if="reviewMode && tumor.cancerTypes_review.get('lastReviewed') !== null && !tumor.name_review.get('added')">
                        <br/>
                        <p>Old Content: </p>
                        <span>{{getLastReviewedCancerTypesName(tumor.cancerTypes_review.get('lastReviewed'))}}</span>
                    </span>
                    <span class="pull-right">
                        <review-panel ng-if="reviewMode" review-obj="tumor.cancerTypes_review" evidence-type="'tumor'" mutation="mutation" tumor="tumor" get-evidence="getEvidence(type, mutation, tumor)" model-update="modelUpdate(type, mutation, tumor)"
                                      confirm-delete="confirmDelete(event, type, mutation, tumor, ti, treatment)" cancel-delete="cancelDelete(event, type, mutation, tumor, ti, treatment)"
                                      accept-added="acceptAdded(event, type, mutation, tumor, ti, treatment)" reject-added="rejectAdded(event, type, mutation, tumor, ti, treatment)"></review-panel>
                    </span>
                </uib-accordion-heading>
                <uib-accordion close-others="false" ng-if="tmpGeneStatus.isOpen">
                  <!--<span><p ng-class="{editableBox:fileEditable, unEditableBox:!fileEditable}" contenteditable="{{fileEditable}}" placeholder="Optional short tumor type summary" ng-model="tumor.shortSummary.text"></p></span>-->
                  <!--<pub-iframe ng-model="tumor.shortSummary.text"></pub-iframe>-->
                <div ng-if="displayPrecisely(tumor.summary_uuid, tumor.summary_review)">
                    <h5><b>Tumor Type Summary (Optional): </b>
                        <review-panel ng-if="reviewMode" review-obj="tumor.summary_review" evidence-type="'TUMOR_TYPE_SUMMARY'" mutation="mutation" tumor="tumor" get-evidence="getEvidence(type, mutation, tumor)" model-update="modelUpdate(type, mutation, tumor)"></review-panel>
                    </h5>
                    <drive-realtime-string review-obj="tumor.summary_review" uuid="::tumor.summary_uuid" es="tumor.summary_eStatus" fe="fileEditable" t="'p'" object="tumor.summary"></drive-realtime-string>
                </div>
                <!-- Prevalence -->
                  <uib-accordion-group ng-init="tmpGeneStatus=getGeneStatusItem(mutation, tumor, null, null, 'prevalence')" ng-if="displayCheck(tumor.prevalence_review, mutation.name_review, tumor.name_review)" is-open="tmpGeneStatus.isOpen" ng-hide="((!!tmpGeneStatus.hideEmpty) && !tumor.prevalence.text && !tumor.shortPrevalence.text) || (status.hideAllObsolete && tumor.prevalence_eStatus.get('obsolete') === 'true')" class="levelThreeHeader">
                    <uib-accordion-heading>
                      <i class="fa  " ng-class="{'fa-chevron-down': tmpGeneStatus.isOpen, 'fa-chevron-right': !tmpGeneStatus.isOpen}" ng-click="changeIsOpen(tmpGeneStatus.isOpen)"></i>
                      <span>{{::tumor.prevalence.display}}: </span>
                      <span class="curationNoEntry" ng-click="stopCollopse($event)" ng-if="tumor.prevalence.text === '' && tumor.shortPrevalence.text === ''">No Entry</span><comments-dict file-editable="fileEditable" comments="tumor.prevalence_comments" object="tumor" key="prevalence" add-comment="addComment(arg1,arg2,arg3)" ng-click="commentClick($event)" ng-keypress="stopCollopse($event)"></comments-dict>
                      <span class="pull-right" ng-show="!reviewMode && fileEditable">
                         <e-status ng-click="commentClick($event)" ng-keypress="stopCollopse($event)" object="tumor.prevalence_eStatus" id="mutation.name.text + tumor.name.text + '-prevalence'" apply-obsolete="applyObsolete(tumor.prevalence_eStatus, 'PREVALENCE', mutation, tumor)"></e-status>
                      </span>
                      <review-panel ng-if="reviewMode" review-obj="tumor.prevalence_review" evidence-type="'PREVALENCE'" mutation="mutation" tumor="tumor" get-evidence="getEvidence(type, mutation, tumor)" model-update="modelUpdate(type, mutation, tumor)"></review-panel>
                    </uib-accordion-heading>
                    <drive-realtime-string review-obj="tumor.prevalence_review" uuid="::tumor.prevalence_uuid" es="tumor.prevalence_eStatus" fe="fileEditable" t="'p'" object="tumor.prevalence" io="tmpGeneStatus.isOpen" ph="'Description of Evidence'"></drive-realtime-string>
                    <drive-realtime-string ng-if="!reviewMode" es="tumor.prevalence_eStatus" fe="fileEditable" t="'p'" object="tumor.shortPrevalence" io="tmpGeneStatus.isOpen" ph="'Additional Information (Optional)'"></drive-realtime-string>
                </uib-accordion-group>

                <!--Diagnostic-->
                <uib-accordion-group ng-init="tmpGeneStatus=getGeneStatusItem(mutation, tumor, null, null, 'diagnostic')" ng-if="displayCheck(tumor.diagnostic_review, mutation.name_review, tumor.name_review)" is-open="tmpGeneStatus.isOpen" ng-hide="((!!tmpGeneStatus.hideEmpty) && !tumor.diagnostic.description.text && !tumor.diagnostic.level.text && !tumor.diagnostic.short.text) || (status.hideAllObsolete && tumor.diagnostic_eStatus.get('obsolete') === 'true')" class="levelThreeHeader">
                    <uib-accordion-heading>
                        <i class="fa  " ng-class="{'fa-chevron-down': tmpGeneStatus.isOpen, 'fa-chevron-right': !tmpGeneStatus.isOpen}" ng-click="changeIsOpen(tmpGeneStatus.isOpen)"></i>
                        <span>Diagnostic implications: </span>
                        <span class="curationNoEntry" ng-click="stopCollopse($event)" ng-if="tumor.diagnostic.description.text === '' && tumor.diagnostic.short.text === '' && tumor.diagnostic.level.text === ''">No Entry</span><comments-dict file-editable="fileEditable" comments="tumor.diagnostic_comments" object="tumor" key="diagnostic" add-comment="addComment(arg1,arg2,arg3)" ng-click="commentClick($event)" ng-keypress="stopCollopse($event)"></comments-dict>
                        <span class="pull-right" ng-show="!reviewMode && fileEditable">
                         <e-status ng-click="commentClick($event)" ng-keypress="stopCollopse($event)" object="tumor.diagnostic_eStatus" id="mutation.name.text + tumor.name.text + '-diagnostic'" apply-obsolete="applyObsolete(tumor.diagnostic_eStatus, 'DIAGNOSTIC', mutation, tumor)"></e-status>
                      </span>
                        <review-panel ng-if="reviewMode" review-obj="tumor.diagnostic_review" evidence-type="'DIAGNOSTIC_IMPLICATION'" mutation="mutation" tumor="tumor" get-evidence="getEvidence(type, mutation, tumor)" model-update="modelUpdate(type, mutation, tumor)"></review-panel>
                    </uib-accordion-heading>
                    <div ng-if="displayPrecisely(tumor.diagnostic.level_uuid, tumor.diagnostic.level_review)" ng-class="{'seperationLine': reviewMode}">
                        <strong>Level of Evidence:</strong><br/>
                        <drive-realtime-string review-obj="tumor.diagnostic.level_review" uuid="::tumor.diagnostic.level_uuid" es="tumor.diagnostic_eStatus" fe="fileEditable" object="tumor.diagnostic.level" t="'implication'" o="levels.diagnostic"></drive-realtime-string><br/>
                    </div>
                    <div ng-if="displayPrecisely(tumor.diagnostic.description_uuid, tumor.diagnostic.description_review)">
                        <strong>Description of Evidence:</strong>
                        <br/>
                        <drive-realtime-string review-obj="tumor.diagnostic.description_review" uuid="::tumor.diagnostic.description_uuid" es="tumor.diagnostic_eStatus" fe="fileEditable" t="'p'" object="tumor.diagnostic.description" io="tmpGeneStatus.isOpen"></drive-realtime-string>
                    </div>
                    <div ng-if="!reviewMode">
                        <strong>Additional Information (Optional):</strong>
                        <br/>
                        <drive-realtime-string es="tumor.diagnostic_eStatus" fe="fileEditable" t="'p'" object="tumor.diagnostic.short" io="tmpGeneStatus.isOpen"></drive-realtime-string>
                    </div>
                </uib-accordion-group>

                  <!-- Prognostic implications -->
                    <uib-accordion-group ng-init="tmpGeneStatus=getGeneStatusItem(mutation, tumor, null, null, 'prognostic')" ng-if="displayCheck(tumor.prognostic_review, mutation.name_review, tumor.name_review)" is-open="tmpGeneStatus.isOpen" ng-hide="((!!tmpGeneStatus.hideEmpty) && !tumor.prognostic.description.text && !tumor.prognostic.level.text && !tumor.prognostic.short.text) || (status.hideAllObsolete && tumor.prognostic_eStatus.get('obsolete') === 'true')" class="levelThreeHeader">
                        <uib-accordion-heading>
                            <i class="fa  " ng-class="{'fa-chevron-down': tmpGeneStatus.isOpen, 'fa-chevron-right': !tmpGeneStatus.isOpen}" ng-click="changeIsOpen(tmpGeneStatus.isOpen)"></i>
                            <span>Prognostic implications: </span>
                            <span class="curationNoEntry" ng-click="stopCollopse($event)" ng-if="tumor.prognostic.description.text === '' && tumor.prognostic.short.text === '' && tumor.prognostic.level.text === ''">No Entry</span><comments-dict file-editable="fileEditable" comments="tumor.prognostic_comments" object="tumor" key="prognostic" add-comment="addComment(arg1,arg2,arg3)" ng-click="commentClick($event)" ng-keypress="stopCollopse($event)"></comments-dict>
                            <span class="pull-right" ng-show="!reviewMode && fileEditable">
                                 <e-status ng-click="commentClick($event)" ng-keypress="stopCollopse($event)" object="tumor.prognostic_eStatus" id="mutation.name.text + tumor.name.text + '-prognostic'" apply-obsolete="applyObsolete(tumor.prognostic_eStatus, 'PROGNOSTIC', mutation, tumor)"></e-status>
                            </span>
                            <review-panel ng-if="reviewMode" review-obj="tumor.prognostic_review" evidence-type="'PROGNOSTIC_IMPLICATION'" mutation="mutation" tumor="tumor" get-evidence="getEvidence(type, mutation, tumor)" model-update="modelUpdate(type, mutation, tumor)"></review-panel>
                        </uib-accordion-heading>
                        <div ng-if="displayPrecisely(tumor.prognostic.level_uuid, tumor.prognostic.level_review)" ng-class="{'seperationLine': reviewMode}">
                            <strong>Level of Evidence:</strong><br/>
                            <drive-realtime-string review-obj="tumor.prognostic.level_review" uuid="::tumor.prognostic.level_uuid" es="tumor.prognostic_eStatus" fe="fileEditable" object="tumor.prognostic.level" t="'implication'" o="levels.prognostic"></drive-realtime-string><br/>
                        </div>
                        <div ng-if="displayPrecisely(tumor.prognostic.description_uuid, tumor.prognostic.description_review)">
                            <strong>Description of Evidence:</strong>
                            <br/>
                            <drive-realtime-string review-obj="tumor.prognostic.description_review" uuid="::tumor.prognostic.description_uuid" es="tumor.prognostic_eStatus" fe="fileEditable" t="'p'" object="tumor.prognostic.description" io="tmpGeneStatus.isOpen"></drive-realtime-string>
                        </div>
                        <div ng-if="!reviewMode">
                            <strong>Additional Information (Optional):</strong>
                            <br/>
                            <drive-realtime-string es="tumor.prognostic_eStatus" fe="fileEditable" t="'p'" object="tumor.prognostic.short" io="tmpGeneStatus.isOpen"></drive-realtime-string>
                        </div>
                    </uib-accordion-group>


                    <!-- NCCN guidelines -->
                  <uib-accordion-group ng-init="tmpGeneStatus=getGeneStatusItem(mutation, tumor, null, null, 'nccn')" ng-if="displayCheck(tumor.nccn_review, mutation.name_review, tumor.name_review)" is-open="tmpGeneStatus.isOpen" ng-hide="((!!tmpGeneStatus.hideEmpty) && !tumor.nccn.disease.text) || (status.hideAllObsolete && tumor.nccn_eStatus.get('obsolete') === 'true')" class="levelThreeHeader">
                    <uib-accordion-heading>
                      <i class="fa  " ng-class="{'fa-chevron-down': tmpGeneStatus.isOpen, 'fa-chevron-right': !tmpGeneStatus.isOpen}" ng-click="changeIsOpen(tmpGeneStatus.isOpen)"></i>
                      <span>NCCN guidelines: </span>
                      <span ng-click="stopCollopse($event)" class="curationNoEntry" ng-if="tumor.nccn.disease.text === '' || tumor.nccn.disease.text === 'NA'">No Entry</span><comments-dict file-editable="fileEditable" comments="tumor.nccn_comments" object="tumor" key="nccn" add-comment="addComment(arg1,arg2,arg3)" ng-click="commentClick($event)" ng-keypress="stopCollopse($event)"></comments-dict>
                      <span class="pull-right" ng-show="!reviewMode && fileEditable">
                         <e-status ng-click="commentClick($event)" ng-keypress="stopCollopse($event)" object="tumor.nccn_eStatus" id="mutation.name.text + tumor.name.text + '-nccn'" apply-obsolete="applyObsolete(tumor.nccn_eStatus, 'NCCN_GUIDELINES', mutation, tumor)"></e-status>
                      </span>
                      <review-panel ng-if="reviewMode" review-obj="tumor.nccn_review" evidence-type="'NCCN_GUIDELINES'" mutation="mutation" tumor="tumor" get-evidence="getEvidence(type, mutation, tumor)" model-update="modelUpdate(type, mutation, tumor)"></review-panel>
                    </uib-accordion-heading>
                    <p ng-class="{'seperationLine': reviewMode}" ng-if="displayPrecisely(tumor.nccn.therapy_uuid, tumor.nccn.therapy_review)">
                        <strong>{{::tumor.nccn.therapy.display}}:</strong>
                        <drive-realtime-string review-obj="tumor.nccn.therapy_review" uuid="::tumor.nccn.therapy_uuid" es="tumor.nccn_eStatus" fe="fileEditable" t="'short'" object="tumor.nccn.therapy"></drive-realtime-string>
                    </p>
                    <p ng-class="{'seperationLine': reviewMode}" ng-if="displayPrecisely(tumor.nccn.disease_uuid, tumor.nccn.disease_review)">
                      <strong>{{::tumor.nccn.disease.display}}:</strong>
                      <drive-realtime-string review-obj="tumor.nccn.disease_review" uuid="::tumor.nccn.disease_uuid" es="tumor.nccn_eStatus" fe="fileEditable" t="'select-chosen'" object="tumor.nccn.disease" o="nccnDiseaseTypes" chosenid="'CurationNCCNDropDown'"></drive-realtime-string>
                    </p>
                    <p ng-class="{'seperationLine': reviewMode}" ng-if="displayPrecisely(tumor.nccn.version_uuid, tumor.nccn.version_review)">
                      <strong>{{::tumor.nccn.version.display}}:</strong>
                      <drive-realtime-string review-obj="tumor.nccn.version_review" uuid="::tumor.nccn.version_uuid" es="tumor.nccn_eStatus" fe="fileEditable" t="'short'" object="tumor.nccn.version"></drive-realtime-string>
                    </p>
                    <span ng-if="displayPrecisely(tumor.nccn.description_uuid, tumor.nccn.description_review)">
                        <strong>Description of Evidence:</strong>
                        <br/>
                        <drive-realtime-string review-obj="tumor.nccn.description_review" uuid="::tumor.nccn.description_uuid" es="tumor.nccn_eStatus" fe="fileEditable" t="'p'" object="tumor.nccn.description" io="tmpGeneStatus.isOpen"></drive-realtime-string>
                    </span>
                    <span ng-if="!reviewMode">
                        <strong>Additional Information (Optional):</strong>
                        <br/>
                        <drive-realtime-string es="tumor.nccn_eStatus" fe="fileEditable" t="'p'" object="tumor.nccn.short" io="tmpGeneStatus.isOpen"></drive-realtime-string>
                    </span>
                  </uib-accordion-group>

                  <!-- Theraputic implications -->
                  <div ng-repeat="ti in tumor.TI.asArray()" class="accordionMarginTop" ng-init="initGeneStatus(mutation, tumor, ti)" ng-hide="status.hideAllObsolete && ti.name_eStatus.get('obsolete') === 'true'">
                    <uib-accordion-group ng-init="tmpGeneStatus=getGeneStatusItem(mutation, tumor, ti); getTreatmentMessages(mutation, tumor, ti)" ng-if="displayCheck(ti.name_review, mutation.name_review, tumor.name_review)" is-open="tmpGeneStatus.isOpen" class="levelThreeHeader" ng-hide="(!!tmpGeneStatus.hideEmpty) && !ti.short.text && !ti.description.text && ti.treatments.length === 0">
                      <uib-accordion-heading>
                        <i class="fa  " ng-class="{'fa-chevron-down': tmpGeneStatus.isOpen, 'fa-chevron-right': !tmpGeneStatus.isOpen}" ng-click="changeIsOpen(tmpGeneStatus.isOpen)"></i>
                        <span>{{::ti.name.text}}: </span>
                        <span ng-click="stopCollopse($event)" class="curationNoEntry" ng-if="!ti.short.text && !ti.description.text && ti.treatments.length === 0">No Entry</span>
                        <comments-dict file-editable="fileEditable" comments="ti.name_comments" object="ti" key="name" add-comment="addComment(arg1,arg2,arg3)" ng-click="commentClick($event)" ng-keypress="stopCollopse($event)"></comments-dict>
                        <span class="pull-right" ng-show="!reviewMode && fileEditable">
                            <e-status ng-click="commentClick($event)" ng-keypress="stopCollopse($event)" object="ti.name_eStatus" id="ti.name.text  + '-name'" apply-obsolete="applyObsolete(ti.name_eStatus, 'TI', mutation, tumor, ti)"></e-status>
                        </span>
                      </uib-accordion-heading>
                      <!--<span><p ng-class="{editableBox:fileEditable, unEditableBox:!fileEditable}" contenteditable="{{fileEditable}}" placeholder="Optional short general summary" ng-model="ti.short.text"></p></span>-->
                      <!--<pub-iframe ng-model="ti.short.text" ng-if="tmpGeneStatus.isOpen"></pub-iframe>-->
                        <div ng-if="displayPrecisely(ti.description_uuid, ti.description_review)">
                            <h5><b>General Summary (Optional): </b>
                                <review-panel ng-if="reviewMode" review-obj="ti.description_review" evidence-type="ti.name.getText()" mutation="mutation" tumor="tumor" therapy-category="ti" get-evidence="getEvidence(type, mutation, tumor, ti)" model-update="modelUpdate(type, mutation, tumor, ti)"></review-panel>
                            </h5>
                            <drive-realtime-string review-obj="ti.description_review" uuid="::ti.description_uuid" es="ti.description_eStatus" fe="fileEditable" t="'p'" object="ti.description"></drive-realtime-string>
                        </div>
                      <uib-accordion close-others="false" ng-if="tmpGeneStatus.isOpen">
                        <div ng-repeat="treatment in ti.treatments.asArray()" ng-init="initGeneStatus(mutation, tumor, ti, treatment)" class="accordionMarginTop">
                            <uib-accordion-group ng-init="tmpGeneStatus=getGeneStatusItem(mutation, tumor, ti, treatment)" ng-if="displayCheck(treatment.name_review, mutation.name_review, tumor.name_review, treatment.name_review) && showEntry(treatment)" is-open="tmpGeneStatus.isOpen" class="levelFourHeader">
                            <uib-accordion-heading>
                              <i class="fa  " ng-class="{'fa-chevron-down': tmpGeneStatus.isOpen, 'fa-chevron-right': !tmpGeneStatus.isOpen}"></i>
                              <span>{{::treatment.type.text}}: </span>
                              <div ng-if="reviewMode && treatment.name_review.get('lastReviewed')"><br/></div>
                              <div style="display:inline-block">
                                   <drive-realtime-string review-obj="treatment.name_review" treatment-messages="treatmentMessages" get-treatment-messages="getTreatmentMessages(mutation, tumor, ti)" uuid="::treatment.name_uuid"  es="treatment.name_eStatus" fe="fileEditable" t="'TREATMENT_NAME'" object="treatment.name" ng-click="stopCollopse($event)" mutation="mutation" tumor="tumor" therapy-category="ti" treatment="treatment" validate-treatment="validateTreatment(newTreatmentName, firstEnter, alert, mutation, tumor, therapyCategory)"></drive-realtime-string>
                              </div>
                              <span ng-click="stopCollopse($event)" class="curationNoEntry" ng-if="!treatment.level.text && !treatment.indication.text && !treatment.description.text && !treatment.short.text">No Entry</span>
                              <comments-dict parent-event="$event" file-editable="fileEditable" comments="treatment.name_comments" object="treatment" key="name" add-comment="addComment(arg1,arg2,arg3)" ng-click="commentClick($event)" ng-keypress="stopCollopse($event)"></comments-dict>
                              <span class="pull-right" ng-show="!reviewMode && fileEditable">
                                <span style="margin-right: 20px">
                                  <i class="fa fa-angle-up" ng-if="$parent.$index !== 0" ng-click="move(ti.treatments, $parent.$index, $parent.$index, $event)"></i>
                                  <i class="fa fa-angle-down" ng-if="$parent.$index !== ti.treatments.length-1" ng-click="move(ti.treatments, $parent.$index, $parent.$index+2, $event)"></i>
                                  <i class="fa fa-angle-double-up" ng-if="$parent.$index > 1" ng-click="move(ti.treatments, $index, 0, $event)"></i>
                                  <i ng-if="$parent.$index < ti.treatments.length-2" class="fa fa-angle-double-down" ng-click="move(ti.treatments, $parent.$index, ti.treatments.length, $event)"></i>
                                </span>
                                 <e-status ng-click="commentClick($event)" ng-keypress="stopCollopse($event)" object="treatment.name_eStatus" id="mutation.name.text + tumor.name.text + ti.name.text + treatment.text" apply-obsolete="applyObsolete(treatment.name_eStatus, 'treatment', mutation, tumor, ti, treatment)"></e-status>
                                <i ng-click="remove($event, 'treatment', mutation, tumor, ti, treatment)" class="fa fa-trash-o"></i>
                              </span>
                              <span class="pull-right">
                                  <review-panel ng-if="reviewMode" review-obj="treatment.name_review" evidence-type="'treatment'" mutation="mutation" tumor="tumor" therapy-category="ti" treatment="treatment" get-evidence="getEvidence(type, mutation, tumor, ti, treatment)" model-update="modelUpdate(type, mutation, tumor, ti, treatment)"
                                                confirm-delete="confirmDelete(event, type, mutation, tumor, ti, treatment)" cancel-delete="cancelDelete(event, type, mutation, tumor, ti, treatment)"
                                                accept-added="acceptAdded(event, type, mutation, tumor, ti, treatment)" reject-added="rejectAdded(event, type, mutation, tumor, ti, treatment)"
                                                get-evidence="getEvidence(type, mutation, tumor, ti, treatment)" model-update="modelUpdate(type, mutation, tumor, ti, treatment)"></review-panel>
                            </span>
                            </uib-accordion-heading>
                            <div ng-if="tmpGeneStatus.isOpen">
                                <p ng-class="{'seperationLine': reviewMode}" ng-if="displayPrecisely(treatment.level_uuid, treatment.level_review)">
                                    <strong>{{::treatment.level.display}}:</strong><br/>
                                  <span ng-if="checkTI(ti, 1, 1)">
                                    <drive-realtime-string review-obj="treatment.level_review" uuid="::treatment.level_uuid" es="treatment.name_eStatus" fe="fileEditable" object="treatment.level" t="'treatment-select'" o="levels.SS"></drive-realtime-string>
                                  </span>
                                  <span ng-if="checkTI(ti, 1, 0)">
                                    <drive-realtime-string review-obj="treatment.level_review" uuid="::treatment.level_uuid" es="treatment.name_eStatus" fe="fileEditable" object="treatment.level" t="'treatment-select'" o="levels.SR" class="floatLeft"></drive-realtime-string>
                                    <i class="fa fa-question-circle" style="color: grey;" uib-tooltip-html="levelExps.SR"></i>
                                  </span>
                                   <span ng-if="checkTI(ti, 0, 1)">
                                    <drive-realtime-string review-obj="treatment.level_review" uuid="::treatment.level_uuid" es="treatment.name_eStatus" fe="fileEditable" object="treatment.level" t="'treatment-select'" o="levels.IS"></drive-realtime-string>
                                  </span>
                                   <span ng-if="checkTI(ti, 0, 0)">
                                    <drive-realtime-string review-obj="treatment.level_review" uuid="::treatment.level_uuid" es="treatment.name_eStatus" fe="fileEditable" object="treatment.level" t="'treatment-select'" o="levels.IR" class="floatLeft"></drive-realtime-string>
                                    <i class="fa fa-question-circle" style="color: grey;" uib-tooltip-html="levelExps.IR"></i>
                                  </span>
                                </p>
                                <div ng-class="{'seperationLine': reviewMode}" ng-if="displayPrecisely(treatment.indication_uuid, treatment.indication_review)">
                                    <strong>{{::treatment.indication.display}}:</strong>
                                    <br/>
                                    <drive-realtime-string review-obj="treatment.indication_review" uuid="::treatment.indication_uuid" es="treatment.name_eStatus" fe="fileEditable" t="'short'" object="treatment.indication" io="tmpGeneStatus.isOpen"></drive-realtime-string>
                                </div>
                                <div ng-if="displayPrecisely(treatment.description_uuid, treatment.description_review)">
                                  <strong>Description of Evidence:</strong>
                                  <br/>
                                  <drive-realtime-string review-obj="treatment.description_review" uuid="::treatment.description_uuid" es="treatment.name_eStatus" fe="fileEditable" t="'p'" object="treatment.description" io="tmpGeneStatus.isOpen"></drive-realtime-string>
                                </div>
                                <div ng-if="!reviewMode">
                                  <strong>Additional Information (Optional):</strong>
                                  <br/>
                                  <drive-realtime-string es="treatment.name_eStatus" fe="fileEditable" t="'p'" object="treatment.short" io="tmpGeneStatus.isOpen"></drive-realtime-string>
                                </div>
                            </div>
                          </uib-accordion-group>
                        </div>
                        <div ng-if="!reviewMode" class="input-group input-group-sm accordionMarginTop">
                          <input type="text" class="form-control" ng-model="newTIName" placeholder="Therapy name" />
                          <span class="input-group-btn">
                            <button type="button" class="btn btn-default" ng-disabled="!(!!newTIName)" ng-click="addTI(newTIName, mutation, tumor, ti); newTIName=''">
                              <i class="fa fa-plus"></i> Add Therapy and {{::(ti.types.get('status').toString() === '0'?'Investigational': 'Standard')}} implications
                            </button>
                          </span>
                        </div>
                      </uib-accordion>
                    </uib-accordion-group>
                  </div>

                  <!-- Trials -->
                  <div class="accordionMarginTop" ng-if="displayPrecisely(tumor.trials_uuid, tumor.trials_review)">
                    <uib-accordion-group ng-init="tmpGeneStatus=getGeneStatusItem(mutation, tumor, null, null, 'trials')" is-open="tmpGeneStatus.isOpen" class="levelThreeHeader" ng-hide="((!!tmpGeneStatus.hideEmpty) && tumor.trials.length === 0) || status.hideAllObsolete && tumor.trials_eStatus.get('obsolete') === 'true'">
                      <uib-accordion-heading>
                        <i class="fa  " ng-class="{'fa-chevron-down': tmpGeneStatus.isOpen, 'fa-chevron-right': !tmpGeneStatus.isOpen}" ng-click="changeIsOpen(tmpGeneStatus.isOpen)"></i>
                        <span>Ongoing clinical trials: </span>
                        <span ng-click="stopCollopse($event)" class="curationNoEntry" ng-if="tumor.trials.length === 0">No Entry</span><comments-dict file-editable="fileEditable" comments="tumor.trials_comments" object="tumor" key="trials" add-comment="addComment(arg1,arg2,arg3)" ng-click="commentClick($event)" ng-keypress="stopCollopse($event)"></comments-dict>
                        <span class="pull-right" ng-show="!reviewMode && fileEditable">
                            <e-status ng-click="commentClick($event)" ng-keypress="stopCollopse($event)" object="tumor.trials_eStatus" id="ti.name.text  + '-trials'" apply-obsolete="applyObsolete(tumor.trials_eStatus, 'CLINICAL_TRIAL', mutation, tumor)"></e-status>
                        </span>
                        <review-panel ng-if="reviewMode" review-obj="tumor.trials_review" evidence-type="'CLINICAL_TRIAL'" mutation="mutation" tumor="tumor" get-evidence="getEvidence(type, mutation, tumor)" model-update="modelUpdate(type, mutation, tumor)"></review-panel>
                      </uib-accordion-heading>

                      <h4 ng-if="reviewMode && !tumor.trials_review.get('action') && !tumor.trials_review.get('removedItem')">New Content:</h4>
                      <div ng-if="!reviewMode || !tumor.trials_review.get('action')">
                          <span class="curateTrialItem" ng-repeat="trial in tumor.trials.asArray()">
                            <a ng-href="https://clinicaltrials.gov/show/{{::trial}}" target="_blank">{{::trial}}</a>
                            <i ng-show="fileEditable" ng-click="removeTrial(tumor.trials, $index, tumor.trials_review, tumor.trials_uuid)" class="fa fa-trash-o"></i>
                          </span>
                          <div class="input-group input-group-sm trialsInputGroup">
                                <input type="text" class="form-control" ng-model="newTrial" placeholder="Trial ID" />
                                <span class="input-group-btn">
                                    <button type="button" class="btn btn-default" ng-disabled="!(!!newTrial)" ng-click="addTrial(tumor.trials, newTrial, tumor.trials_review, tumor.trials_uuid); newTrial=''">
                                        <i class="fa fa-plus"></i> Add Trial
                                    </button>
                                    <!-- <button type="button" class="btn btn-default" ng-if="::(userRole === 8)" ng-click="cleanTrial(tumor.trials)">
                                    <i class="fa fa-plus"></i> Clean Trial
                                    </button> -->
                                </span>
                          </div>
                      </div>
                      <br/><br/>
                      <div style="float:left" ng-if="reviewMode">
                          <h4 ng-if="!tumor.trials_review.get('action') && !tumor.trials_review.get('removedItem')">Old Content:</h4>
                          <div ng-if="!tumor.trials_review.get('action') && !tumor.trials_review.get('removedItem')">
                              <span ng-if="tumor.trials_review.get('lastReviewed').length > 0" class="curateTrialItem reviewedBG" ng-repeat="x in tumor.trials_review.get('lastReviewed')">
                                <a ng-href="https://clinicaltrials.gov/show/{{::x}}" target="_blank">{{::x}}</a>
                              </span>
                              <p class="reviewedBG" ng-if="!tumor.trials_review.get('lastReviewed') || tumor.trials_review.get('lastReviewed').length === 0">No Entry</p>
                          </div>
                          <div ng-if="tumor.trials_review.get('action')">
                              <span ng-if="tumor.trials.length > 0" class="curateTrialItem reviewedBG" ng-repeat="x in tumor.trials.asArray()">
                                <a ng-href="https://clinicaltrials.gov/show/{{::x}}" target="_blank">{{::x}}</a>
                              </span>
                              <p class="reviewedBG" ng-if="tumor.trials.length === 0">No Entry</p>
                          </div>
                      </div>
                    </uib-accordion-group>
                  </div>
                </uib-accordion>
              </uib-accordion-group>
            </div>
          </uib-accordion>
            <!-- <hr/>
                          <h4>Interacting alterations:</h4>
                          <p>
                      <strong><comments-dict file-editable="fileEditable" comments="tumor.interactAlts.alterations_comments" object="tumor.interactAlts" key="alterations" add-comment="addComment(arg1,arg2,arg3)"></comments-dict>{{tumor.interactAlts.alterations.display}}:</strong>
                      <input type='text' ng-class="{editableBox:fileEditable, unEditableBox:!fileEditable}" contenteditable="{{fileEditable}}" ng-model="tumor.interactAlts.alterations.text"/>
                </p>
                <span>
                      <strong><comments-dict file-editable="fileEditable" comments="tumor.interactAlts.description_comments" object="tumor.interactAlts" key="description" add-comment="addComment(arg1,arg2,arg3)"></comments-dict>{{tumor.interactAlts.description.display}}:</strong>
                      <p class="doubleH" type='text' ng-class="{editableBox:fileEditable, unEditableBox:!fileEditable}" contenteditable="{{fileEditable}}" ng-model="tumor.interactAlts.description.text"></p>
                </span> -->
            <div style="width: 100%; margin: 0 5px" class="input-group input-group-sm accordionMarginTop"
                 ng-if="!reviewMode && (tmpGeneStatus.isOpen || (status.numAccordion < 100 && gene.mutations.length < 20) || (status.numAccordion < 200 && gene.mutations.length < 6))">
                <h4>Add tumor type(s)</h4>
                <hr/>
                <div class="add-tumor-type-item" ng-repeat="cancerType in meta.newCancerTypes">
                    Cancer Type: <select chosen
                                       allow-single-deselect="true"
                                       data-placeholder="Choose a main tumor type"
                                       no-results-text="'Could not find any'"
                                       ng-model="cancerType.mainType"
                                       ng-options="tt.name for tt in oncoTree.mainTypes | orderBy: 'name'">
                    <option value=""></option>
                </select>
                    Subtype:
                    <select style="width: 400px" chosen
                            data-placeholder="Choose a tumor type"
                            no-results-text="'Could not find any'"
                            allow-single-deselect="true"
                            ng-model="cancerType.subtype"
                            ng-options="tt.name for tt in cancerType.oncoTreeTumorTypes | orderBy: 'name' track by tt.code">
                        <option value=""></option>
                    </select>
                </div>
                <button type="button" class="btn btn-default btn-sm"
                        ng-disabled="meta.newMainType.length === 0"
                        ng-click="addTumorType(mutation); meta.newTumorType=''">
                    Add Tumor Type(s)
                </button>
            </div>
        </uib-accordion-group>
      </div>
    </uib-accordion>
  </div>
    <div ng-if="!reviewMode">
        <div class="input-group input-group-sm accordionMarginTop">
            <input type="text" class="form-control" ng-model="newMutationName" placeholder="{{::addMutationPlaceholder}}"  uib-typeahead="suggestedMutation for suggestedMutation in suggestedMutations | filter:$viewValue:stateComparator" empty-typeahead  ng-click="opened=!opened" focus-me="opened" ng-focus="onFocus($event)" />
            <span class="input-group-btn">
              <button type="button" class="btn btn-default" ng-disabled="!(!!newMutationName)" ng-click="addMutation(newMutationName); newMutationName=''">
                <i class="fa fa-plus"></i> Add Mutation
              </button>
            </span>
        </div>
        <hr/>
        <div id="vus">
            <h3>Variants of Unknown Significance (Investigated and data not found) <button class="btn btn-default btn-sm" ng-click="vusUpdate('click update to database button')" ng-if="developerCheck()">Update to database</button></h3>
            <div ng-repeat="variant in vus.asArray()">
                <vus-item vus="vus" index="$index" file-editable="fileEditable" d-model="model" comments="variant.name_comments"  object="variant" key="name" add-comment="addComment(arg1,arg2,arg3)" ng-click="commentClick($event)" ng-keypress="stopCollopse($event)" vus-update="vusUpdate(message)"></vus-item>
            </div>

            <div class="input-group input-group-sm vusGroup">
                <input type="text" class="form-control" ng-model="newVUSName" placeholder="Variant Name"/>
                <span class="input-group-btn">
                      <button type="button" class="btn btn-default" ng-disabled="!(!!newVUSName)"
                              ng-click="addVUSItem(newVUSName, newVUSTime); newVUSName=''">
                        <i class="fa fa-plus"></i> Add Variant
                      </button>
                    </span>
            </div>
        </div>
        <curation-queue specify-annotation="specifyAnnotation()" location="'gene'"></curation-queue>
    </div>
</div>
<div ng-hide="status.rendering" class="floatToolBox btn-group btn-group-sm" role="group">
  <span class="btn btn-default" style="opacity: 1" disabled>{{::gene.name.text}}</span>
  <button type="button" class="btn btn-default" ng-click="generatePDF()">Download PDF</button>
  <button type="button" class="btn btn-default" ng-click="status.hideAllEmpty=true">
    <i class="fa fa-eye-slash"></i>Hide all empty
  </button>
  <button type="button" class="btn btn-default" ng-click="status.hideAllEmpty=false">
    <i class="fa fa-eye"></i>Show all empty
  </button>
  <button ng-if="::(userRole === 8)" type="button" class="btn btn-default" ng-click="status.hideAllObsolete=true">
    <i class="fa fa-eye-slash"></i>Hide all obsolete
  </button>
  <button ng-if="::(userRole === 8)" type="button" class="btn btn-default" ng-click="status.hideAllObsolete=false">
    <i class="fa fa-eye-slash"></i>Show all obsolete
  </button>
    <button type="button" class="btn btn-default" ng-click="status.expandAll=true"
            ng-if="(status.numAccordion < 100 && gene.mutations.length < 20) || (status.numAccordion < 200 && gene.mutations.length < 6)">
    <i class="fa fa-expand"></i>Expand all
  </button>
  <button type="button" class="btn btn-default"  ng-click="status.expandAll=false"
          ng-if="(status.numAccordion < 100 && gene.mutations.length < 20) || (status.numAccordion < 200 && gene.mutations.length < 6)">
    <i class="fa fa-compress"></i>Collapse all
  </button>
  <!--<button type="button" class="btn btn-default"  ng-click="status.expandAll=!status.expandAll">-->
    <!--<i class="fa " ng-class="{'fa-compress':status.expandAll, 'fa-expand':!status.expandAll}"></i>-->
    <!--<span ng-if="!status.expandAll">Expand</span><span ng-if="status.expandAll">Collapse</span> all-->
  <!--</button>-->
  <!--<button type="button" class="btn btn-default" ng-click="status.hideAllEmpty=!status.hideAllEmpty">-->
    <!--<i class="fa " ng-class="{'fa-eye':status.hideAllEmpty, 'fa-eye-slash':!status.hideAllEmpty}"></i>-->
    <!--<span ng-if="!status.hideAllEmpty">Hide</span><span ng-if="status.hideAllEmpty">Show</span> all empty-->
  <!--</button>-->
  <!--<button type="button" class="btn btn-default" ng-if="::(userRole === 8)" ng-click="getData()">Check gene data</button>-->
  <button ng-style="{color: updateGeneColor()}" type="button" class="btn btn-default" ng-if="::(userRole === 8 && developerCheck())" ng-click="updateGene()"><span ng-show="!!!docStatus.savedGene"><i class="fa fa-spinner fa-spin"></i></span><span ng-show="!!docStatus.savedGene">Update gene</span></button>
  <!--<button type="button" class="btn btn-default" ng-if="::(userRole === 8)" ng-click="getComments()">Check comments</button>-->
    <!--<button type="button" class="btn btn-default" ng-if="::(userRole === 8)" ng-click="checkScope()">Check Scope</button>-->
  <span class="btn btn-default" disabled><span ng-show="docStatus.saving">Saving <i class="fa fa-spinner fa-spin"></i></span><span ng-show="docStatus.saved">All changes saved</span><span style="color: red; font-weight: bold;" ng-show="docStatus.closed">Error saving the changes, please refresh the page</span></span>
</div>
<loading ng-model="status.saveDataToDatabase" content="Please wait, we are saving the data into database." class="loading-save-to-database"></loading>
<loading ng-model="status.rendering" content="Please wait, we are loading gene information."></loading>
